{"version":3,"file":"bundle.js","sources":["../src/scripts/Base_Game.js","../src/scripts/components/Renderer.js","../src/scripts/components/Loader.js","../src/scripts/components/GameObject.js","../src/scripts/components/SaveableObject.js","../src/scripts/components/Room.js","../src/scripts/components/InteractiveObject.js","../src/scripts/components/AnimatableObject.js","../src/scripts/components/Gui.js","../src/scripts/components/Character.js","../src/scripts/components/RoomObject.js","../src/scripts/game.js"],"sourcesContent":["// Main game Object.\r\n\r\n// settings: {\r\n//      gameContainer   _ID of container in which to insert the game\r\n//      height          _real height of the game window\r\n//      width           _real width of the game window\r\n//      scale           _zoom factor to show a bigger game\r\n//      fontsize        _default fontsize used for text\r\n// }\r\n\r\n\r\n// base game object.\r\nvar Game = function (settingsObject, gameData) {\r\n\r\n    // ----------- settings ------------\r\n\r\n    // the settings object is used for the general settings of the game\r\n    // that do not influence gameplay directly\r\n    this.settings = {\r\n        baseMediaPath: './media/',\r\n        height: 0,\r\n        width: 0,\r\n        scale: 1,\r\n        fontsize: 30,\r\n        gameContainer: 'gamebox'\r\n    };\r\n\r\n    // take the passed settings:\r\n    for (var attrname in settingsObject) {\r\n        this.settings[attrname] = settingsObject[attrname];\r\n    }\r\n\r\n    // ------------ other vars -------------\r\n\r\n    // create the game objects. We pass in a reference to this object.\r\n    this.gameData = gameData(this);\r\n\r\n\r\n    this.data = {\r\n        waiting: false\r\n    };\r\n\r\n    // here, we save variables used at the game runtime\r\n    // e.g. the current hover text, the selected action\r\n    // in short: nothing worth saving.\r\n    this.currentState = {\r\n\r\n    };\r\n\r\n    // this is a container where you can put all the variables of your logic\r\n    // that don't fit anywhere else.\r\n    // e.g. didHeroSeeTheCat: false\r\n    this.vars = {};\r\n\r\n    // an array for chaining multiple actions in the game\r\n    // so that different characters can wait for each other, etc.\r\n    this.actionList = [];\r\n\r\n    // a boolean controlling the flow of the action.\r\n    this.runningActions = false;\r\n    this._currentAction = null;\r\n\r\n    // used for save events:\r\n    this._saveData = {};\r\n\r\n    // Modules\r\n    this._loadedComponents = {};\r\n\r\n\r\n    // ---------- construction ------------\r\n\r\n    // create event loads all the required modules.\r\n    this.triggerEvent('create');\r\n\r\n    // add the connection to the modules to the game data.\r\n    this.gameData.connect();\r\n\r\n    this.triggerEvent('prepare');\r\n\r\n    console.log ('-------- game system ready. -------');\r\n};\r\n\r\n// the events are set in the prototype so that they can still be editable\r\n// independently of an instance.\r\nGame.prototype.events = {\r\n    create: []\r\n};\r\n\r\n/*Game.prototype.prepare = function () {\r\n    this.triggerEvent('prepare');\r\n};*/\r\n\r\nGame.prototype.init = function () {\r\n    this.triggerEvent('init');\r\n    this.addEventListener('update', this.doActions.bind(this));\r\n};\r\n\r\n\r\n// ************** SAVING / LOADING *****************\r\n\r\n// JSON.stringify(value);\r\n// JSON.parse(value);\r\nGame.prototype.save = function (slot) {\r\n    // if no saveslot was specified, save to autosave-slot 0.\r\n    if (typeof slot === 'undefined') slot = 0;\r\n\r\n    this.triggerEvent('beforeSave');\r\n\r\n    var saveData = this._saveData;\r\n    console.log (saveData);\r\n\r\n    var textSaveData = JSON.stringify(saveData);\r\n    console.log (textSaveData);\r\n\r\n    localStorage.setItem('save' + slot, textSaveData);\r\n    console.log ('SAVING: saved data to save' + slot);\r\n};\r\n\r\nGame.prototype.load = function (slot) {\r\n    // if no saveslot was specified, load from autosave-slot 0.\r\n    if (typeof slot === 'undefined') slot = 0;\r\n\r\n    var textSaveData = localStorage.getItem('save' + slot);\r\n    console.log ('LOADING: loaded save' + slot, textSaveData);\r\n\r\n    this._saveData = JSON.parse(textSaveData);\r\n    console.log ('Parsed save data: ', this._saveData);\r\n\r\n    this.triggerEvent('onSavegameLoad');\r\n\r\n    this.triggerEvent('afterSavegameLoad');\r\n};\r\n\r\n// ************** ACTION LIST **********************\r\n\r\nGame.prototype.doActions = function () {\r\n    if (this.runningActions) {\r\n        this.runningActions = false;\r\n\r\n        // get the next goal if don't have one or the action can be jumped over.\r\n        if ((this._currentAction === null || this._currentAction.blocking === false) && this.actionList.length > 0) {\r\n            var a = this.actionList.shift();\r\n            this._currentAction = a.action;\r\n            a.element.runAction(a.action);\r\n        }\r\n    }\r\n};\r\n// add an action to the action queue:\r\nGame.prototype.pushAction = function (element, action) {\r\n    this.actionList.push ({element: element, action: action});\r\n    this.runningActions = true;\r\n};\r\n// a method to mark the end of an action execution.\r\nGame.prototype.nextAction = function () {\r\n    game.currentState.blockingAction = false;\r\n    this._currentAction = null;\r\n    this.runningActions = true;\r\n};\r\n\r\n// add a waiting action (wait for ... milliseconds)\r\nGame.prototype.wait = function (time) {\r\n    this.pushAction (this, {action: 'wait', time: time});\r\n};\r\nGame.prototype.runAction = function (action) {\r\n    if (action.action === 'wait') {\r\n        game.currentState.blockingAction = true;\r\n        setTimeout (this.nextAction.bind(this), action.time);\r\n    }\r\n};\r\n\r\n// ************** STATIC METHODS **********************\r\n\r\nlet componentCalls = {};\r\n\r\n/**\r\n * @params: componentName   _the name of the component to add\r\n *          dependencies    _an array with all the componentNames of the components it needs to work\r\n  *         callback        _the building function that creates the component (called on 'create')\r\n**/\r\nGame.addComponent = function functionName(componentName, dependencies, callback) {\r\n\r\n    componentCalls[componentName] = callback;\r\n\r\n    // add to global event list.\r\n    Game.prototype.events.create.push(function () {\r\n\r\n        this.activateComponent(componentName, dependencies);\r\n    });\r\n\r\n    console.log ('Game: added component ' + componentName);\r\n};\r\n\r\n\r\n// ******************* COMPONENTS *************************\r\n\r\nGame.prototype.activateComponent = function (componentName, dependencies) {\r\n\r\n    console.log ('Components: activating component ' + componentName);\r\n\r\n    // get the object to each dependency (eg. dependency 'renderer' gets the module with the name 'renderer')\r\n    var resolvedDeps = [];\r\n    var l = dependencies.length;\r\n    while (l--) {\r\n        resolvedDeps[l] = this._loadedComponents[dependencies[l]];\r\n\r\n        // give an error if the dependency was not found.\r\n        if (typeof resolvedDeps[l] === 'undefined') {\r\n            console.error('Components: The component \"' + dependencies[l] + '\" could not be added as dependency. (requested in ' + componentName + ')\\nMake sure you load it before any component that is dependent on it.');\r\n        }\r\n    }\r\n\r\n    // to pass a reference to the current game instance to the components,\r\n    // add \"this\" as the first argument.\r\n    resolvedDeps.unshift(this);\r\n\r\n    // build the components, save them with their names\r\n    this._loadedComponents[componentName] = componentCalls[componentName].apply(null, resolvedDeps);\r\n\r\n    // the var has served its purpose. Not needed any longer.\r\n    //delete componentCalls;\r\n};\r\n\r\n/**\r\n *  Inserts the methods of a prototype to a different prototype\r\n *\r\n */\r\nGame.prototype.mixinPrototype = function (receiver, donator, overwrite) {\r\n    // loop through all the properties of the donator prototype:\r\n    for ( var property in donator ) {\r\n        if ( donator.hasOwnProperty(property) ) {\r\n\r\n            // if the receiver does not have the property (or if we chose to overwrite it)\r\n            // save the property/method to the receiving object\r\n            if (overwrite || receiver.hasOwnProperty(property) === false) {\r\n                receiver[property] = donator[property];\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nGame.prototype.mixinComponent = function (receiver, donator, overwrite) {\r\n    this.mixinPrototype(receiver.prototype, donator.prototype, overwrite);\r\n\r\n    // save the component to the list of parent components:\r\n    if (typeof receiver.prototype.pears !== 'array') receiver.prototype.pears = [];\r\n    receiver.prototype.pears.push (donator.name);\r\n};\r\n\r\n\r\n\r\n// ************************ EVENTS ***********************\r\n\r\n// events are the way the different components in the system should communicate\r\n// with each other.\r\n// every component can trigger events and share data through that way.\r\n// Every component can listen to events and 'get notified' when something happened.\r\n\r\n\r\nGame.prototype.addEventListener = function (eventName, callback) {\r\n    // create the event if it doesn't exist\r\n    if (typeof this.events[eventName] === 'undefined') {\r\n        this.events[eventName] = [];\r\n    }\r\n    // add the callback to the list of stuff to be done when the event is triggered\r\n    this.events[eventName].push(callback);\r\n};\r\nGame.prototype.removeEventListener = function (eventName, callback) {\r\n    var index = this.events[eventName].indexOf(callback);\r\n\r\n    // If the callback wasn't registered, throw error.\r\n    if (index === -1) {\r\n        throw \"Callback is not registered on event \" + eventName;\r\n    }\r\n\r\n    this.events[eventName].splice(index, 1);\r\n};\r\n\r\n// trigger an event, activating every added callbacks\r\nGame.prototype.triggerEvent = function (eventName) {\r\n    var eventlist = this.events[eventName];\r\n\r\n    if (typeof eventlist === 'undefined') {\r\n        //console.log (\"No callbacks on event \" + eventName);\r\n        return;\r\n    }\r\n    // don't log when 'update' is triggered. happens too often.\r\n    if (! (eventName === 'update')) console.log ('Event: ' + eventName + ' triggered.');\r\n\r\n    // call every callback - in the order they were registered.\r\n    var l = eventlist.length;\r\n    for (var i = 0; i < l; i++) {\r\n        eventlist[i].apply(this, Array.prototype.slice.call(arguments, 1));\r\n    }\r\n};\r\n\r\nexport default Game;\r\n","// the renderer component serves as bridge to the PIXI functions and objects.\r\n\r\nlet PIXI = require('pixi.js');\r\n\r\nconsole.log (PIXI);\r\n\r\n// ==== Preparing the canvas ===\r\n\r\n// local variables\r\nvar renderer = null;\r\nvar gameWidth = 0;\r\nvar gameHeight = 0;\r\nvar time = new Date().getTime();\r\n\r\n// set the scale mode to pixel perfect (nearest neighbor)\r\nPIXI.settings.SCALE_MODE = PIXI.SCALE_MODES.NEAREST;\r\n\r\nvar Renderer = function () {\r\n\r\n    // hook functions\r\n    this.onRender = function(){};\r\n\r\n    // --------------- construct the object -------------\r\n\r\n    // Autodetect and create the renderer\r\n    renderer = PIXI.autoDetectRenderer(game.settings.width, game.settings.height);\r\n\r\n    // Set the background color of the renderer to a baby-blue'ish color\r\n    renderer.backgroundColor = 0x04180b;\r\n\r\n    // set the game width.\r\n    this.width = renderer.width / 2;\r\n    this.width = renderer.height / 2;\r\n\r\n    // Create the main stage\r\n    this.stage = new PIXI.Container();\r\n\r\n    // set the 'zoom' level according to the settings\r\n    this.stage.scale.y = this.stage.scale.x = game.settings.scale;\r\n\r\n\r\n    game.addEventListener('init', this.init.bind(this));\r\n};\r\n\r\nRenderer.prototype.init = function () {\r\n\r\n    // add the renderer view element to the DOM\r\n    document.getElementById(game.settings.gameContainer).appendChild(renderer.view);\r\n\r\n    // start the draw cicle\r\n    this.draw();\r\n};\r\n\r\n\r\n\r\nRenderer.prototype.draw = function () {\r\n\r\n    // get the time elapsed since last draw:\r\n    var newTime = new Date().getTime();\r\n    var deltaT = newTime - time;\r\n    time = newTime;\r\n\r\n\t/*if (fade > -1) {\r\n\t\tFade ();\r\n\t}\r\n\telse {\r\n\t\tdrawGui (context_gui);\r\n\t\tfor (var i = 0; i < AnimateList.length;i++) {\r\n\t\t\tif (AnimateList[i].room == loadedRoom) AnimateList[i].animate ();\r\n\t\t\tdrawObjects ();\r\n\t\t}\r\n\t\t// Regelmäßiges Screenupdate bei Bildänderung\r\n\t\tif (didsomethingchange) {\r\n\t\t\tdrawObjects ();\r\n\t\t\tdidsomethingchange = false;\r\n\t\t}\r\n\t}*/\r\n\r\n    this.onRender(deltaT);\r\n\r\n    game.triggerEvent('update', deltaT);\r\n\r\n    // Render our container\r\n    renderer.render(this.stage);\r\n\r\n\trequestAnimationFrame( this.draw.bind(this) );\r\n}\r\n\r\n// method to sort the layers\r\nfunction depthCompare(a, b) {\r\n    if (a.z < b.z)  return -1;\r\n    if (a.z > b.z)  return 1;\r\n    return 0;\r\n}\r\n\r\nRenderer.prototype.addLayer = function (layer) {\r\n    this.stage.addChild(layer);\r\n    this.stage.children.sort(depthCompare);\r\n};\r\nRenderer.prototype.removeLayer = function (layer) {\r\n    this.stage.removeChild(layer);\r\n};\r\n\r\n// ========= EXTENDING CLASSES ==========\r\n\r\n// make a layer, extending the container.\r\nRenderer.prototype.Layer = function () {\r\n    PIXI.Container.call(this);\r\n    this.z = 0;\r\n};\r\nRenderer.prototype.Layer.prototype = Object.create (PIXI.Container.prototype, {});\r\nRenderer.prototype.Layer.constructor = Renderer.prototype.Layer;\r\nRenderer.prototype.Layer.prototype.sortChildren = function () {\r\n    this.children.sort(depthCompare);\r\n};\r\n\r\nRenderer.prototype.createSprite = function (image) {\r\n    return new PIXI.Sprite.fromImage (game.settings.baseMediaPath + image);\r\n};\r\n\r\n// give access to PIXI classes.\r\nRenderer.prototype.Sprite = PIXI.Sprite;\r\nRenderer.prototype.AnimatedSprite = PIXI.extras.AnimatedSprite;\r\nRenderer.prototype.Text = PIXI.Text;\r\nRenderer.prototype.Graphics = PIXI.Graphics;\r\nRenderer.prototype.Rectangle = PIXI.Rectangle;\r\n\r\nexport default Renderer;\r\n","﻿// Das hier ist ein Modul, das alle Ressourcen managed, damit es bei der Laufzeit des Spiel zu keinen Fehlern kommt.\n\nlet _ = require('lodash');\n\nvar basePath = '';\n\nvar Loader = function () {\n\tthis.loader = PIXI.loader;\n\n\t// a list of all the loaded resources:\n\tthis.resources = [];\n\n\t// a list of stuff that has to be loaded.\n\tthis.toLoad = [];\n\n\tbasePath = game.settings.baseMediaPath;\n\n\tgame.addEventListener ('init', this.loadMedia.bind(this, this.toLoad, this._afterInitialLoad));\n};\n\n// a helper function that eliminates duplicates in an array:\n/*function uniq(arr) {\n    return arr.sort().filter(function(item, pos, ary) {\n        return !pos || item != ary[pos - 1];\n    })\n}*/\n\nLoader.prototype.loadMedia  = function (mediaList, callback) {\n\n\tif (mediaList.length === 0) {\n\t\tconsole.log ('Nothing to load. Proceeding.');\n\t\tcallback();\n\t\treturn;\n\t}\n\n\tmediaList = _.uniq(mediaList);\n\n\tconsole.log ('Loader: media list to load: ', mediaList);\n\n\t//this.loader.reset();\n\n\tvar newRessources = 0;\n\n\t// add every picture to load list\n\tvar i = mediaList.length;\n\twhile (i--) {\n\t\t// add the resource - if it is not loaded yet.\n\t\tif (!this.resources[mediaList[i]]) {\n\t\t\tthis.loader.add(mediaList[i], basePath + mediaList[i]);\n\t\t\tnewRessources++;\n\t\t}\n\t}\n\n\t// if any new ressources have been added to the loader, load them:\n\tif (newRessources > 0) {\n\t\tthis.loader.load(this._mediaLoaded.bind(this, callback));\n\t}\n\t// if all ressources have already been loaded, call the callback directly:\n\telse {\n\t\tconsole.log ('Loader: All resources already loaded. Proceeding.');\n\t\tcallback();\n\t}\n\n\treturn this;\n\t//DrawLoadingScreen (\"Der Header wird geladen.\");\n};\n\nLoader.prototype.addToLoadQueue = function (resArray) {\n\tvar i = resArray.length;\n\twhile (i--) {\n\t\tthis.toLoad.push (resArray[i]);\n\t}\n};\n\n// ==== internal functions ====\n\nLoader.prototype._mediaLoaded = function (callback, loader, resources) {\n\tthis.resources = resources;\n\tconsole.log ('Loader: loaded resources. ', this.resources);\n\tcallback();\n};\n\nLoader.prototype._afterInitialLoad = function () {\n\tgame.triggerEvent('game_loaded');\n\tconsole.log ('------- game successfully loaded -------');\n};\n\nexport default Loader;\n","/**\r\n *  The Game Object is a base object that provides some functions all the different game elements might need.\r\n *  It can't be used by itself, though.\r\n */\r\n\r\nimport Loader from './Loader.js';\r\n\r\n\r\n    function GameObject () {\r\n\r\n    }\r\n\r\n    // the game object default options:\r\n    var DEFAULTS =\r\n    {\r\n            position: {\r\n                x: 0,               //  _x position (required)\r\n                y: 0                //  _y position (required)\r\n            },\r\n            z: 0,                   //  _z-index (used to order the objects on screen)\r\n            visible: true,          //  _can the object be seen on screen\r\n            interactive: true,      //  _can the user click on the object?\r\n            width: 0,               //  _width of the object\r\n            height: 0,              //  _height of the object\r\n            baseline: 1,\r\n            name: '',               //  _a readable display name (eg. 'Fernseher')\r\n            tint: 0xFFFFFF,         //  _changing color of the object\r\n\r\n                                    //  _some function hooks\r\n            onClick: function() {},\r\n            onMouseIn: function() {},\r\n            onMouseOut: function() {}\r\n    };\r\n\r\n    // vars that should not be set in the options, but have to be saved:\r\n    var saveValues = [];\r\n\r\n    // the core constructor function.\r\n    GameObject.prototype.construct = function (scriptName, options) {\r\n        this.scriptName = scriptName;\r\n\r\n        // save all the passed properties in the object.\r\n        options = this._getDefaultProperties (options, DEFAULTS);\r\n\r\n        // since this is the base class of other objects, all the options should\r\n        // be used up right now. Otherwise, give a notice.\r\n        let keys = Object.keys(options);\r\n        if (keys.length > 0) console.log ('There are still options of '+ this.scriptName + ':', keys);\r\n\r\n        // we need to back up some options, because the loading process meddles with some properties\r\n        // (especially sizes.)\r\n        this._afterLoadOptions = {\r\n            width: options.width,\r\n            height: options.height,\r\n            baseline: options.baseline\r\n        };\r\n        if (typeof this._afterLoadOptions.baseline === 'undefined') this._afterLoadOptions.baseline = 1;\r\n\r\n        // internal vars:\r\n        this._clickedAt = false;\r\n        this._loaded = false;\r\n\r\n        // setup events\r\n        this\r\n            // events for drag start\r\n            .on('mousedown', this.handleMouseDown)\r\n            .on('touchstart', this.handleMouseDown)\r\n            // events for drag end\r\n            .on('mouseup', this.handleMouseUp)\r\n            .on('mouseupoutside', this.handleMouseUpOutside)\r\n            .on('touchend', this.handleMouseUp)\r\n            .on('touchendoutside', this.handleMouseUpOutside)\r\n            // events for drag move\r\n            //.on('mousemove', onDragMove)\r\n            //.on('touchmove', onDragMove);\r\n\r\n            // set the mouseover callback...\r\n            .on('mouseover', this.handleMouseOver)\r\n\r\n            // set the mouseout callback...\r\n            .on('mouseout', this.handleMouseOut);\r\n\r\n            //console.log(this);\r\n\r\n        return options;\r\n    };\r\n\r\n    // === internal methods ===\r\n\r\n    // save all the options in the options to the GameObject, if a default value exists for them\r\n    GameObject.prototype._getDefaultProperties = function (options, defaults) {\r\n\r\n        // create an internal var to save if we set an option at any point:\r\n        if (typeof this['_alreadySet'] === 'undefined') this['_alreadySet'] = [];\r\n\r\n        // get all the options from the option object\r\n        for (var variable in defaults) {\r\n\r\n            if (options.hasOwnProperty(variable)) {\r\n\r\n                /*if (typeof options[variable] === 'array') {\r\n                    console.log (variable + ' is an array...');\r\n                }\r\n                else if (typeof options[variable] === 'object') {\r\n                    console.log (variable + ' is an object...');\r\n                }*/\r\n                this[variable] = options[variable];\r\n\r\n                // delete the option, we hav deelt wit it.\r\n                delete options[variable];\r\n                this._alreadySet.push(variable);\r\n            }\r\n            // set the value to the default value\r\n            // if the property was not already set anywhere\r\n            else if (this._alreadySet.indexOf(variable) === -1) {\r\n                this[variable] = defaults[variable];\r\n                this._alreadySet.push(variable);\r\n            }\r\n        }\r\n\r\n        return options;\r\n    };\r\n\r\n    // some properties have to be updated after the object has been loaded.\r\n    GameObject.prototype._updatePropsAfterLoad = function () {\r\n        this.scale.x = this.scale.y = 1;\r\n        if (this._afterLoadOptions.height) this.height = this._afterLoadOptions.height;\r\n        if (this._afterLoadOptions.width) this.width = this._afterLoadOptions.width;\r\n        if (this._afterLoadOptions.baseline) this.baseline = this._afterLoadOptions.baseline * this.height;\r\n\r\n        this.z = this.y + this.baseline;\r\n\r\n        delete this._afterLoadOptions;\r\n    };\r\n\r\n    // ========== saving ==============\r\n\r\n    GameObject.prototype._getSaveData = function () {\r\n        var saveData = {};\r\n\r\n        for (var property in DEFAULTS) {\r\n            if (this.hasOwnProperty(property)) {\r\n                saveData[property] = this[property];\r\n            }\r\n        }\r\n        var i = saveValues.length;\r\n        while (i--) {\r\n            saveData[saveValues[i]] = this[saveValues[i]];\r\n        }\r\n\r\n        return saveData;\r\n    };\r\n\r\n    // ==========  event handlers ==============\r\n\r\n    GameObject.prototype.handleMouseDown = function (event) {\r\n        this._clickedAt = true;\r\n    };\r\n    GameObject.prototype.handleMouseUp = function (event) {\r\n        if (this._clickedAt) {\r\n            this._clickedAt = false;\r\n\r\n            // user-editable click event hook\r\n            if (!game.currentState.blockingAction) {\r\n                event.stopPropagation();\r\n                this.onClick();\r\n            }\r\n            else if (typeof game.currentState.passAction === 'function') {\r\n                console.log ('Interaction: aborted current action.');\r\n                game.currentState.passAction();\r\n            }\r\n            else {\r\n                console.log ('Interaction: Click ignored.');\r\n            }\r\n        }\r\n    };\r\n    GameObject.prototype.handleMouseUpOutside = function (event) {\r\n\r\n        this._clickedAt = false;\r\n    };\r\n    GameObject.prototype.handleMouseOver = function (event) {\r\n\r\n        // save the hovered element on a game wide state:\r\n        if (game.currentState.hoveredElement !== this)\r\n            game.currentState.hoveredElement = this;\r\n\r\n        // user-editable mouse-in event hook\r\n        this.onMouseIn();\r\n    };\r\n    GameObject.prototype.handleMouseOut = function (event) {\r\n\r\n        // user-editable mouse-out event hook\r\n        this.onMouseOut();\r\n    };\r\n\r\nexport default GameObject;\r\n","// vars that should not be set in the options, but have to be saved:\r\nvar saveValues = [];\r\n\r\nfunction SaveableObject () {\r\n\r\n}\r\n\r\n// return all the properties of the object that we want to save.\r\nSaveableObject.prototype._getSaveData = function (propertiesToSave) {\r\n\tvar saveData = {};\r\n\r\n\tfor (var property in propertiesToSave) {\r\n\t\tif (this.hasOwnProperty(property)) {\r\n\t\t\tsaveData[property] = this[property];\r\n\t\t}\r\n\t}\r\n\tvar i = saveValues.length;\r\n\twhile (i--) {\r\n\t\tsaveData[saveValues[i]] = this[saveValues[i]];\r\n\t}\r\n\r\n\treturn saveData;\r\n};\r\n\r\n\r\n\r\nexport default SaveableObject;\r\n","// Das hier ist das Raum-Modul\r\n\r\nimport Renderer from './Renderer.js';\r\nimport Loader from './Loader.js';\r\n\r\n//Game.addComponent ('room', ['renderer', 'loader'], function (game, renderer, loader) {\r\n\r\n\t// ***************** ROOM OBJECT *****************\r\n\r\n\tvar DEFAULTS = {\r\n\t\tname: '',\t\t// _ a readable, descriptive Name of the room\r\n\t\tmusic: '',\t\t// _ the name of the music file to play in that room\r\n\t\tloop: true,\r\n\r\n\t\tenter : function () {},\r\n\t\trepEx : function () {},\r\n\t\tleave : function () {}\r\n\t};\r\n\tvar saveValues = [\r\n\t\t'visited'\r\n\t];\r\n\r\n\tvar Room = function (scriptName, options) { // image, width, height, scriptName, options) {\r\n\r\n\t\t// create the layer this room will be drawn in:\r\n\t\tthis.layer = new renderer.Layer();\r\n\t\tthis.backgroundImg = options.image;\r\n\r\n\t\t// save the important options:\r\n\t\tthis.scriptName = scriptName;\r\n\t\tthis.width = options.width;\r\n\t\tthis.height = options.height;\r\n\r\n\t\t// save the optional options:\r\n\t\t// get all the options from the option object\r\n\t\tfor (var variable in DEFAULTS) {\r\n\t\t\t///console.log (variable, options[variable]);\r\n\t\t\tif (options.hasOwnProperty(variable)) {\r\n\t\t\t\tthis[variable] = options[variable];\r\n\t\t\t\t//console.log (variable, options[variable]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis[variable] = DEFAULTS[variable];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.music) {\r\n\t\t\tif (this.loop) this.music.loop = true;\r\n\t\t}\r\n\r\n\t\tthis._resourceList = [\r\n\t\t\tthis.backgroundImg\r\n\t\t];\r\n\r\n\t\tthis.visited = 0;\r\n\r\n\t\t// add the new Room to the game Room list\r\n\t\troomList.push(this);\r\n\t\tthis.id = roomList.length - 1;\r\n\t\troomMap[scriptName] = this.id;\r\n\r\n\t\tconsole.log ('Room: Created room ' + this.scriptName);\r\n\t}\r\n\r\n\t// ==== private variables ====\r\n\r\n\tvar roomList = [];\r\n\tvar roomMap = {};\r\n\tvar _options = {};\r\n\r\n\tvar currentRoom = '';\r\n\tvar currentRoomNbr = -1;\r\n\r\n\t// ==== public functions ====\r\n\r\n\tRoom.prototype.addElement = function (element) {\r\n\t\tthis.layer.addChild(element);\r\n\t\tthis.layer.sortChildren();\r\n\t};\r\n\tRoom.prototype.removeElement = function (element) {\r\n\t\tthis.layer.removeChild(element);\r\n\t\tthis.layer.sortChildren();\r\n\t};\r\n\r\n\tRoom.prototype.load = function () {\r\n\r\n\t\t// if that room is currently loaded, don't do anything.\r\n\t\tif (currentRoomNbr === this.id) return;\r\n\r\n\t\t// if a room is currently loaded, unload that one first.\r\n\t\tif (currentRoomNbr !== -1) {\r\n\t\t\troomList[currentRoomNbr].unload();\r\n\t\t}\r\n\r\n\t\tcurrentRoom = this.scriptName;\r\n\t\tcurrentRoomNbr = this.id;\r\n\r\n\t\t//viewport.set (0, 0);\r\n\t\tthis.visited++;\r\n\r\n\t\tloader.loadMedia(this._resourceList, this._resourcesLoaded.bind(this));\r\n\r\n\t\t\t\t\t// Musikübergang --> ...wenn musik eingebaut.\r\n\r\n\t\t\t\t\t/*var prevsnd = null;\r\n\t\t\t\t\tif (game.currentRoom) {\r\n\t\t\t\t\t\td_log (\"vorheriger Raum:\" + game.currentRoom.name);\r\n\t\t\t\t\t\tif (game.currentRoom.music) prevsnd = game.currentRoom.music;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (prevsnd !== this.music) {\r\n\t\t\t\t\t\tif (prevsnd) prevsnd.pause ();\r\n\t\t\t\t\t\tif (this.music) this.music.currentTime = 0;\r\n\t\t\t\t\t\tif (this.music) this.music.play ();\r\n\t\t\t\t\t}*/\r\n\r\n\t\t//new Message (this.name, 60, 590).display();\r\n\r\n\r\n\r\n\t\tconsole.log ('Room: Raum ' + this.scriptName + ' geladen. ');\r\n\t};\r\n\r\n\tRoom.prototype.unload = function () {\r\n\r\n\t\t\t// Offene Daten vom letzten Raum entfernen (geöffnete Dialoge, Sätze, usw.)\r\n\t\t\t/*if (mouse.hoveredElement){\r\n\t\t\t\tmouse.hoveredElement.hoverOff ();\r\n\t\t\t\tmouse.hoveredElement = null;\r\n\t\t\t}\r\n\t\t\tactualDialog = null;\r\n\t\t\tMessageList.splice (0, MessageList.length);\r\n\t\t\tSayList.splice (0, SayList.length);*/\r\n\r\n\t\t// call leave action of the room.\r\n\t\tif (this.leave) this.leave ();\r\n\r\n\t\trenderer.removeLayer(this.layer);\r\n\r\n\t\tcurrentRoom = '';\r\n\t\tcurrentRoomNbr = -1;\r\n\t};\r\n\r\n\t// === internal functions ===\r\n\r\n\tRoom.prototype._handleClick = function (event) {\r\n\t\tvar point = event.data.getLocalPosition(this.background);\r\n\t\tgame.triggerEvent('room_click', point, event);\r\n\t\t//console.log ('Room clicked ', point);\r\n\t};\r\n\r\n\tRoom.prototype._getSaveData = function () {\r\n\t\tvar saveData = {};\r\n\t\tfor (var property in DEFAULTS) {\r\n\t\t\tif (this.hasOwnProperty(property)) {\r\n\t\t\t\tsaveData[property] = this[property];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar i = saveValues.length;\r\n\t\twhile (i--) {\r\n\t\t\tsaveData[saveValues[i]] = this[saveValues[i]];\r\n\t\t}\r\n\r\n\t\treturn saveData;\r\n\t};\r\n\r\n\tRoom.prototype._resourcesLoaded = function () {\r\n\t\t// load room background and add it to the canvas\r\n\t\tthis.background = new renderer.Sprite(loader.resources[this.backgroundImg].texture);\r\n\t\t// make sure the background image is always drawn in the back.\r\n\t\tthis.background.z = -500;\r\n\t\tthis.layer.addChild(this.background);\n\n\t\tthis.background.interactive = true;\n\t\tthis.background.on('mouseup', this._handleClick.bind(this));\r\n\r\n\t\trenderer.addLayer(this.layer);\r\n\r\n\t\tif (this.enter) this.enter ();\r\n\t\tgame.triggerEvent('room_loaded', this.scriptName);\r\n\r\n\t\tconsole.log ('------ room completely loaded -----');\r\n\r\n\t\tgame.addEventListener ('update', this._onCycle.bind(this));\r\n\t};\r\n\r\n\tRoom.prototype._onCycle = function (deltaTime) {\r\n\t\t// check if the room is currently loaded\r\n\t\tif (currentRoomNbr === this.id) {\r\n\t\t\t// TODO: some sort of flag or somtin to prevent continous sorting\r\n\t\t\tif (game.currentState.zUpdated) {\r\n\t\t\t\tthis.layer.sortChildren();\r\n\t\t\t\tgame.currentState.zUpdated = false;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// ==== static functions ====\r\n\r\n\tRoom.get = function (roomName) {\r\n\t\tif (typeof roomMap[roomName] === 'undefined') {\r\n\t\t\tthrow \"Kein Raum mit dem Namen \" + roomName + \" vorhanden.\";\r\n\t\t}\r\n\t\tvar roomId = roomMap[roomName];\r\n\r\n\t\treturn roomList[roomId];\r\n\t};\r\n\tRoom.load = function (roomName) {\r\n\t\tconsole.log ('-------------------------------');\r\n\t\tconsole.log ('Room: Loading room ' + roomName);\r\n\t\tconsole.log ('currently in room ' + currentRoom);\r\n\t\tRoom.get(roomName).load();\r\n\t};\r\n\r\n\tRoom.getCurrent = function () {\r\n\t\treturn Room.get(currentRoom);\r\n\t};\r\n\r\n\t// ==== create the rooms ====\r\n\r\n\t// load everything from the configuration and wire the properties into real files.\r\n\tfunction setupRooms () {\r\n\t\tvar roomConfig = game.gameData.room;\r\n\r\n\t\t// split the options from the rest of the settings object:\r\n\t\t_options = roomConfig.options;\r\n\t\tdelete roomConfig.options;\r\n\r\n\t\t// save the variables from the options:\r\n\t\tcurrentRoom = _options.currentRoom;\r\n\r\n\t\t// make rooms from the rest of the array:\r\n\t\tfor (var roomName in roomConfig) {\r\n\t\t\tif (roomConfig.hasOwnProperty(roomName)) {\r\n\t\t\t\tnew Room (roomName, roomConfig[roomName]); /*.image,\r\n\t\t\t\t \t\t\troomConfig[roomName].width,\r\n\t\t\t\t\t\t\troomConfig[roomName].height,\r\n\t\t\t\t\t\t\troomName,\r\n\t\t\t\t\t\t\troomConfig[roomName].options);*/\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log ('Room: All rooms created: ', roomList);\r\n\t\tconsole.log ('-----');\r\n\t};\r\n\r\n\t/*function loadFirstRoom () {\r\n\t\tif (_options.currentRoom !== 'undefined') {\r\n\t\t\tRoom.load (_options.currentRoom);\r\n\t\t}\r\n\t};*/\r\n\r\n\t// process a save event\r\n\tgame.addEventListener ('beforeSave', function () {\r\n\r\n\t\tvar saveRooms = {};\r\n\r\n\t\tsaveRooms.settings = {\r\n\t\t\tcurrentRoom: currentRoom,\r\n\t\t};\r\n\r\n\t\t// loop through all the rooms:\r\n\t\tvar i = roomList.length;\r\n\t\twhile (i--) {\r\n\t\t\tconsole.log (roomList[i].scriptName);\r\n\t\t\tsaveRooms[roomList[i].scriptName] = roomList[i]._getSaveData();\r\n\t\t}\r\n\r\n\t\tgame._saveData.room = saveRooms;\r\n\t});\r\n\r\n\t// process a load event\r\n\tgame.addEventListener ('onSavegameLoad', function () {\r\n\t\tvar roomConfig = game._saveData.room;\r\n\r\n\t\t// split the options from the rest of the settings object:\r\n\t\t_options = roomConfig.settings;\r\n\t\tdelete roomConfig.settings;\r\n\r\n\t\t// save the variables from the options:\r\n\t\tcurrentRoom = _options.currentRoom;\r\n\r\n\t\t// loop through all the rooms in the save:\r\n\t\tfor (var roomName in roomConfig) {\r\n\t\t\tvar r = Room.get(roomName);\r\n\r\n\t\t\t// change all the properties of the current rooms to the saved props.\r\n\t\t\tfor (var variable in roomConfig[roomName]) {\r\n\t\t\t\tr[variable] = roomConfig[roomName][variable];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log ('ROOM: all room properties loaded.');\r\n\t});\r\n\r\n\t// bind the creation to the game events\r\n\tgame.addEventListener('prepare', setupRooms);\r\n\tgame.addEventListener('game_loaded', function () {\r\n\t\tRoom.load (currentRoom);\r\n\t});\r\n\r\nexport default Room;\r\n","import Renderer from './Renderer.js';\r\nimport Loader from './Loader.js';\r\n\r\nimport GameObject from './GameObject.js';\r\n\r\n\r\n//Game.addComponent ('interactive_object', ['renderer', 'loader', 'game_object'], function (game, renderer, loader, GameObject) {\r\n\r\nfunction InteractiveObject (scriptName, options) {\r\n    renderer.Sprite.call(this, null);\r\n\r\n    options = this._getDefaultProperties (options, DEFAULTS);\r\n    this.construct(scriptName, options, DEFAULTS);\r\n\r\n    this._resourceList = [\r\n        this.image\r\n    ];\r\n};\r\n\r\nvar DEFAULTS = {\r\n    image: ''              //  _image name to use (required)\r\n};\r\n\r\n// vars that should not be set in the options, but have to be saved:\r\nvar saveValues = [];\r\n\r\nInteractiveObject.prototype = Object.create(renderer.Sprite.prototype);\r\nInteractiveObject.constructor = InteractiveObject;\r\n\r\n\r\n// === loading methods ===\r\n\r\nInteractiveObject.prototype._attachLoadedTexture = function () {\r\n    this.texture = loader.resources[this.image].texture;\r\n    this._updatePropsAfterLoad();\r\n    this._loaded = true;\r\n};\r\n\r\n// === saving ===\r\n\r\nInteractiveObject.prototype._getSaveData = function () {\r\n    // save all the default values from the inherited class\r\n    var saveData = GameObject.prototype._getSaveData.call(this);\r\n\r\n\tfor (var property in DEFAULTS) {\r\n\t\tif (this.hasOwnProperty(property)) {\r\n\t\t\tsaveData[property] = this[property];\r\n\t\t}\r\n\t}\r\n\tvar i = saveValues.length;\r\n\twhile (i--) {\r\n\t\tsaveData[saveValues[i]] = this[saveValues[i]];\r\n\t}\r\n\r\n\treturn saveData;\r\n};\r\n\r\n// add the extension to the prototype\r\ngame.mixinComponent (InteractiveObject, GameObject);\r\n\r\nexport default InteractiveObject;\r\n","// the animatable object is basically the interactive object with animation functions.\r\n// use texturePacker to pack animation sheets for this frame.\r\n\r\nimport Renderer from './Renderer.js';\r\nimport Loader from './Loader.js';\r\nimport GameObject from './GameObject.js';\r\n\r\n//Game.addComponent ('animatable_object', ['renderer', 'loader', 'game_object'], function (game, renderer, loader, GameObject) {\r\n\r\n// set the default settings:\r\nvar DEFAULTS = {\r\n    autoplay: true,                 // _play the animation after loading\r\n    animationSpeed: 0.5,            // _default: 1 -> 60 fps.\r\n    views: [],\r\n    anchor: {\r\n        x: 0,\r\n        y: 0\r\n    },\r\n    onFrame : function (frame) {\r\n\r\n    }\r\n};\r\n\r\n// vars that should not be set in the options, but have to be saved:\r\nvar saveValues = [];\r\n\r\nAnimatableObject = function (scriptName, options) {\r\n    renderer.AnimatedSprite.call(this, [PIXI.Texture.EMPTY]);\r\n\r\n    options = this._getDefaultProperties (options, DEFAULTS);\r\n\r\n    // construct the GameObject\r\n    this.construct.call(this, scriptName, options);\r\n\r\n    this._resourceList = [];\r\n\r\n    _loadViews.apply(this);\r\n};\r\n\r\nAnimatableObject.prototype = Object.create(renderer.AnimatedSprite.prototype);\r\nAnimatableObject.constructor = AnimatableObject;\r\n\r\n// === private functions ===\r\n\r\n// load all the views of the object and add the required variables.\r\nfunction _loadViews () {\r\n\r\n    // adding variables:\r\n    this._resolvedViews = {};\r\n    this._viewTextures = {};\r\n    this.currentView = '';\r\n\r\n    // get the images from the view:\r\n    var l = this.views.length;\r\n    for (var i = 0; i < l; i++) {\r\n        _loadView.apply (this, [ this.views[i] ]);\r\n    }\r\n\r\n    // set the default view to the first view\r\n    this.currentView = this.views[0];\r\n}\r\n\r\n// load the elements of a view\r\nfunction _loadView (view) {\r\n\r\n    // get to the right 'folder'\r\n    var parts = view.split('/');\r\n    var dir = game.gameData.views;\r\n    var l = parts.length;\r\n    for (var i = 0; i < l; i++) {\r\n        dir = dir[parts[i]];\r\n    }\r\n    // save the 'folder' for future use\r\n    this._resolvedViews[view] = dir;\r\n\r\n    // add the view image(s) to the resources to load.\r\n    this._resourceList.push(dir.image);\r\n};\r\n\r\ngame.mixinComponent(AnimatableObject, GameObject);\r\n\r\n\r\n// === internal functions ===\r\n\r\nAnimatableObject.prototype._attachLoadedTexture = function () {\r\n\r\n    var i = this.views.length;\r\n    while (i--) {\r\n\r\n        var textureArray = [];\r\n        var view = this._resolvedViews[ this.views[i] ];\r\n\r\n        var l = view.frames.length;\r\n        for (var j = 0; j < l; j++) {\r\n            textureArray.push (loader.resources[view.image].textures[view.frames[j]]);\r\n        }\r\n\r\n        this._viewTextures[ this.views[i] ] = textureArray;\r\n    }\r\n\r\n    this.textures = this._viewTextures[this.currentView];\r\n    this.texture = this.textures[0];\r\n\r\n    // reset size to fit the new textures.\r\n    this.scale.x = this.scale.y = 1;\n\n    this._updatePropsAfterLoad();\r\n\r\n    if (this.autoplay) {\r\n        console.log (this.name + ' starting to play.');\r\n        this.play();\r\n    }\r\n\r\n    this._loaded = true;\r\n};\r\n\r\nAnimatableObject.prototype._getSaveData = function () {\r\n\r\n    // save all the default values from the inherited class\r\n    var saveData = GameObject.prototype._getSaveData.call(this);\r\n\r\n\tfor (var property in DEFAULTS) {\r\n\t\tif (this.hasOwnProperty(property)) {\r\n\t\t\tsaveData[property] = this[property];\r\n\t\t}\r\n\t}\r\n\tvar i = saveValues.length;\r\n\twhile (i--) {\r\n\t\tsaveData[saveValues[i]] = this[saveValues[i]];\r\n\t}\r\n\r\n\treturn saveData;\r\n};\r\n\r\nAnimatableObject.prototype.update = function (deltaTime) {\r\n    renderer.AnimatedSprite.prototype.update.call(this, deltaTime);\r\n    this._handleFrameChange();\r\n    this.onFrame(this.currentFrame);\r\n};\r\n\r\nAnimatableObject.prototype._handleFrameChange = function () {\r\n    //var frame = this.currentFrame;\r\n}\r\n\r\nexport default GameObject;\r\n","// Das hier ist das Raum-Modul\r\n\r\nimport Renderer from './Renderer.js';\r\nimport Loader from './Loader.js';\r\n\r\nimport GameObject from './GameObject.js';\r\nimport AnimatableObject from './AnimatableObject.js';\r\nimport InteractiveObject from './InteractiveObject.js';\r\n\r\n//Game.addComponent ('gui', ['renderer', 'loader', 'game_object', 'interactive_object', 'animatable_object'],\r\n//function (game, renderer, Loader, GameObject, InteractiveObject, AnimatableObject) {\r\n\r\n\t// ***************** GUI CONTAINER *****************\r\n\r\n\tvar DEFAULTS = {\r\n\t\tz: 10,\r\n\t\tvisible: false,\r\n\t\tposition: {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0\r\n\t\t}\r\n\t};\r\n\tvar saveValues = [];\r\n\r\n\tvar Gui = function (scriptName, options) {\r\n\r\n\t\trenderer.Layer.call(this);\r\n\r\n\t\t// save the important options:\r\n\t\tthis.scriptName = scriptName;\r\n\r\n\t\t// save the optional options:\r\n\t\t// get all the options from the option object\r\n\t\tfor (var variable in DEFAULTS) {\r\n\t\t\t///console.log (variable, options[variable]);\r\n\t\t\tif (options.hasOwnProperty(variable)) {\r\n\t\t\t\tthis[variable] = options[variable];\r\n\t\t\t\t//console.log (variable, options[variable]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis[variable] = DEFAULTS[variable];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._resourceList = [];\r\n\t\tthis.objectList = [];\r\n\t\tthis.objectMap = {};\r\n\r\n        // add the new GUI to the game GUI list\r\n\t\tguiList.push(this);\r\n\t\tthis.id = guiList.length - 1;\r\n\t\tguiMap[scriptName] = this.id;\r\n\r\n\t\t// add the layer to the canvas\r\n\t\tif (this.visible === true) {\r\n\t\t\tthis.show();\r\n\t\t}\r\n\r\n\t\tconsole.log ('Gui: Created gui ' + this.scriptName);\r\n\t}\r\n\r\n\r\n    Gui.prototype = Object.create(renderer.Layer.prototype);\r\n    Gui.constructor = Gui;\r\n\r\n\t// ==== private variables ====\r\n\r\n\tvar _options = {};\r\n    var guiMap = {};\r\n    var guiList = [];\r\n\r\n\t// ==== public functions ====\r\n\r\n\tGui.prototype.addChild = function (element) {\r\n\t\trenderer.Layer.prototype.addChild.call(this, element);\r\n\t\tthis.sortChildren();\r\n\t};\r\n\tGui.prototype.removeChild = function (element) {\r\n        // call the removeChild function of the inherited class:\r\n        renderer.Layer.prototype.removeChild.call(this, element);\r\n\t\tthis.sortChildren();\r\n\t};\r\n\r\n\tGui.prototype.show = function () {\r\n\t\tthis.visible = true;\r\n\t\trenderer.addLayer(this);\r\n\t};\r\n\r\n\tGui.prototype.hide = function () {\r\n\t\tthis.visible = false;\r\n\t\trenderer.removeLayer (this);\r\n\t};\r\n\r\n\tGui.prototype.load = function () {\r\n\r\n        /*\r\n        // load background and add it to the canvas\r\n\t\tthis.background = new renderer.Sprite(Loader.resources[this.backgroundImg].texture);\r\n\t\t// make sure the background image is always drawn in the back.\r\n\t\tthis.background.z = -500;\r\n\t\tthis.addChild(this.background);\r\n        */\r\n\r\n        /* background interaction\r\n\t\tthis.background.interactive = true;\r\n\t\tthis.background.on('mouseup', this._handleClick.bind(this));\r\n        */\r\n\r\n\t\tgame.triggerEvent('gui_loaded', this.scriptName);\r\n\r\n\t\t//game.addEventListener ('update', this._onCycle.bind(this));\r\n\t};\r\n\r\n\r\n\t// ============= GUI CONTENT ELEMENTS ===============\r\n\r\n\tGui.prototype.addObject = function (scriptName, options) {\r\n\r\n        var newObject = null;\r\n\r\n\t\t// check for text\r\n\t\tlet hasText = false;\r\n\t\tlet text = null;\r\n\t\tif (options.text) {\r\n\t\t\tvar style = {};\r\n\t\t\tif (typeof options.textStyle !== 'undefined') style = options.textStyle;\r\n\t\t\ttext = new renderer.Text(options.text, style);\r\n\t\t\ttext.anchor.x = 0;\r\n            text.x = options.textPosition.x || 0;\r\n            text.y = options.textPosition.y || -this.height;\r\n\r\n\t\t\tdelete options.text;\r\n\t\t\tdelete options.textPosition;\r\n\t\t\tdelete options.textStyle;\r\n\r\n\t\t\thasText = true;\r\n\t\t}\r\n\r\n\t\tlet type = options.type;\r\n\t\tdelete options.type;\r\n\r\n        // create an animatable object or a standard object\r\n        if (type === 'animated') {\r\n            newObject = new AnimatableObject(scriptName, options);\r\n        }\r\n        else if (type === 'image') {\r\n            newObject = new InteractiveObject(scriptName, options);\r\n        }\r\n\t\telse if (type === 'graphic') {\r\n\t\t\tnewObject = new renderer.Graphics(); //scriptName, options\r\n\r\n\t\t\tvar GRAPHIC_DEFAULTS = {\r\n\t\t\t\t// graphic defaults\r\n\t\t\t\tsize: {\r\n\t\t\t\t\tw: 100,\r\n\t\t\t\t\th: 100\r\n\t\t\t\t},\r\n\t\t\t\tlineWidth: 0,\r\n\t\t\t\tlineColor: 0x000000,\r\n\t\t\t\tlineAlpha: 1,\r\n\t\t\t\tfillColor: 0xFFFFFF,\r\n\t\t\t\tfillAlpha: 1,\r\n\r\n\t\t\t\t// type: 'graphic'\r\n\t\t\t\t// text: '',\r\n\t\t\t\t// textPosition: {\r\n\t\t\t\t// \tx: 0,\r\n\t\t\t\t// \ty: 0\r\n\t\t\t\t// },\r\n\t\t\t\t// textStyle: {\r\n\t\t\t\t// \tfontFamily: 'Arial',\r\n\t\t\t\t// \tfontSize: '16px',\r\n\t\t\t\t// \tfontWeight: 'normal'\r\n\t\t\t\t// }\r\n\t\t\t};\r\n\r\n\t\t\t// add the functions of an InteractiveObject to the graphic button\r\n\t\t\tgame.mixinPrototype (newObject, GameObject.prototype);\r\n\r\n\t\t\tnewObject._getDefaultProperties(options, GRAPHIC_DEFAULTS);\r\n\t\t\tGameObject.prototype.construct.call(newObject, scriptName, options);\r\n\r\n\r\n\t\t\tnewObject._resourceList = [];\r\n\r\n\t\t\t// draw a rectangle\r\n\t\t\tnewObject.beginFill(newObject.fillColor, newObject.fillAlpha);\r\n\t\t\tnewObject.lineStyle(newObject.lineWidth, newObject.lineColor, newObject.lineAlpha);\r\n\t\t\tnewObject.drawRect(0, 0, newObject.size.w, newObject.size.h);\r\n\r\n\t\t\tnewObject.hitArea = new renderer.Rectangle(0, 0, newObject.size.w, newObject.size.h);\r\n\t\t}\r\n\t\tnewObject.type = type;\r\n\r\n\t\tif (hasText === true) {\r\n\t\t\tnewObject.addChild(text);\r\n\t\t}\r\n\r\n\r\n        // add the object to the room object list\r\n        this.objectList.push (newObject);\r\n\r\n        // set the object id\r\n        newObject.id = this.objectList.length - 1;\r\n        this.objectMap[scriptName] = newObject.id;\r\n\r\n        // add the image to the list of resources to load when entering the room:\r\n        var oRes = newObject._resourceList.length;\r\n        while (oRes--) {\r\n            this._resourceList.push(newObject._resourceList[oRes]);\r\n        }\r\n\r\n        // set the name of the objects room\r\n        newObject.guiName = this.scriptName;\r\n\r\n        // when the object's room loads, load the object.\r\n        game.addEventListener('gui_loaded', onLoadGui.bind(null, newObject));\r\n\r\n        console.log ('Gui: created element ' + newObject.scriptName);\r\n    };\r\n\r\n    Gui.prototype.deleteObject = function (objectName) {\r\n        var id = this.objectMap[objectName];\r\n\r\n        // remove the object from the scene\r\n        this.removeElement (this.objectList[id]);\r\n\r\n        // remove the objects texture from the resource list\r\n        this._resourceList.splice(this._resourceList.indexOf(this.objectList[id].image), 1);\r\n\r\n        // remove the object from the object name map\r\n        delete this.objectMap[objectName];\r\n\r\n        // replace the object with null.\r\n        // todo: reorder the whole object list... or not?\r\n        this.objectList[id] = null;\r\n    };\r\n\r\n\t// load event - called when all the resources in the room are loaded.\r\n    function onLoadGui (object, guiName) {\r\n\r\n\t\t//console.log ('gui ' + object.scriptName + ' ready');\r\n        // only load it if the loaded gui is the gui the object is in.\r\n        if (guiName !== object.guiName) return;\r\n\r\n        // create the image element of the object - if the element is not a plain graphic.\r\n        if (!object._loaded && object.type !== 'graphic') {\r\n\t\t\tobject._attachLoadedTexture ();\r\n\t\t}\r\n\r\n        // add the element to the room layer\r\n        var gui = Gui.get(guiName);\r\n        gui.addChild(object);\r\n\r\n        console.log ('Gui: loaded object ' + object.scriptName, object);\r\n    }\r\n\r\n\t// === internal functions ===\r\n\r\n\tGui.prototype._handleClick = function (event) {\r\n\t\tvar point = event.data.getLocalPosition(this);\r\n\t\tgame.triggerEvent('gui_click', point, event);\r\n\t};\r\n\r\n\tGui.prototype._getSaveData = function () {\r\n\t\tvar saveData = {};\r\n\t\tfor (var property in DEFAULTS) {\r\n\t\t\tif (this.hasOwnProperty(property)) {\r\n\t\t\t\tsaveData[property] = this[property];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar i = saveValues.length;\r\n\t\twhile (i--) {\r\n\t\t\tsaveData[saveValues[i]] = this[saveValues[i]];\r\n\t\t}\r\n\r\n\t\treturn saveData;\r\n\t};\r\n\r\n\tGui.prototype._onCycle = function (deltaTime) {\r\n\r\n\t};\r\n\r\n\t// ==== static functions ====\r\n\r\n\tGui.get = function (guiName) {\r\n\t\tif (typeof guiMap[guiName] === 'undefined') {\r\n\t\t\tthrow \"Kein Raum mit dem Namen \" + guiName + \" vorhanden.\";\r\n\t\t}\r\n\t\tvar guiId = guiMap[guiName];\r\n\r\n\t\treturn guiList[guiId];\r\n\t};\r\n\r\n\t// ==== create the guis ====\r\n\r\n\t// load everything from the configuration and wire the properties into real elements.\r\n\tfunction setupGuis () {\r\n\t\tvar guiConfig = game.gameData.gui;\r\n\r\n\t\t// split the options from the rest of the settings object:\r\n\t\t_options = guiConfig.options;\r\n\t\tdelete guiConfig.options;\r\n\r\n\t\t// make guis from the rest of the array:\r\n\t\tfor (var guiName in guiConfig) {\r\n\t\t\tif (guiConfig.hasOwnProperty(guiName)) {\r\n\t\t\t\tvar options = guiConfig[guiName];\r\n\r\n\t\t\t\t// split the gui elements from the gui container options:\r\n\t\t\t\tvar elements = {};\r\n\t\t\t\tif (typeof options.elements !== 'undefined') {\r\n\t\t\t\t\telements = options.elements;\r\n\t\t\t\t\tdelete options.elements;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// create the gui container:\r\n\t\t\t\tvar g = new Gui (guiName, options);\r\n\r\n\t\t\t\t// create all the different gui elements:\r\n\t\t\t\tfor (var element in elements) {\r\n\t\t\t\t\tg.addObject(element, elements[element]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// add the resources of this element to the general game loadlist\r\n\t\t        // (so that we don't have to wait in the game for a gui to load)\r\n\t\t        Loader.addToLoadQueue(g._resourceList);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log ('Gui: All guis created: ', guiList);\r\n\t\tconsole.log ('-----');\r\n\t};\r\n\r\n\tfunction createGuis () {\r\n\t\t// loop though all guis:\r\n\t\tvar i = guiList.length;\r\n\t\twhile (i--) {\r\n\t\t\t// load every single one:\r\n\t\t\tguiList[i].load();\r\n\t\t}\r\n\t};\r\n\r\n\t// process a save event\r\n\tgame.addEventListener ('beforeSave', function () {\r\n\r\n\t\tvar saveGuis = {};\r\n\r\n\t\tsaveGuis.settings = {\r\n\r\n\t\t};\r\n\r\n\t\t// loop through all the guis:\r\n\t\tvar i = guiList.length;\r\n\t\twhile (i--) {\r\n\t\t\tconsole.log (guiList[i].scriptName);\r\n\t\t\tsaveGuis[guiList[i].scriptName] = guiList[i]._getSaveData();\r\n\t\t}\r\n\r\n\t\tgame._saveData.gui = saveGuis;\r\n\t});\r\n\r\n\t// process a load event\r\n\tgame.addEventListener ('onSavegameLoad', function () {\r\n\t\tvar guiConfig = game._saveData.gui;\r\n\r\n\t\t// split the options from the rest of the settings object:\r\n\t\t_options = guiConfig.settings;\r\n\t\tdelete guiConfig.settings;\r\n\r\n\t\t// loop through all the guis in the save:\r\n\t\tfor (var guiName in guiConfig) {\r\n\t\t\tvar r = Gui.get(guiName);\r\n\r\n\t\t\t// change all the properties of the current guis to the saved props.\r\n\t\t\tfor (var variable in guiConfig[guiName]) {\r\n\t\t\t\tr[variable] = guiConfig[guiName][variable];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log ('GUI: all gui properties loaded.');\r\n\t});\r\n\r\n\t// bind the creation to the game events\r\n\tgame.addEventListener('prepare', setupGuis);\r\n\tgame.addEventListener('game_loaded', createGuis);\r\n\r\nexport default Gui;\r\n","// the animatable object is basically the interactive object with animation functions.\r\n// use texturePacker to pack animation sheets for this frame.\r\n\r\nimport Renderer from './Renderer.js';\r\nimport Loader from './Loader.js';\r\nimport AnimatableObject from './AnimatableObject.js';\r\nimport Room from './Room.js';\r\n\r\n\r\n    var DEFAULTS = {\r\n        walkspeed: 5,\r\n        dir: 'down',\r\n        roomName: '',\r\n        isPlayer: false,\r\n        dirViews: null,\r\n        talkViews: null,\r\n        speechStyle: {\r\n            color: 0x000000,\r\n            fontSize: 26,\r\n            fontFamily: 'Arial'\r\n        }\r\n    };\r\n\r\n    // vars that should not be set in the options, but have to be saved:\r\n    var saveValues = [\r\n\r\n    ];\r\n\r\n    function Character (scriptName, options) {\r\n\r\n    // change object defaults to character defaults:\r\n    if (typeof options.anchor === 'undefined') options.anchor = {x: 0.5, y: 1};\r\n    if (typeof options.baseline === 'undefined') options.baseline = 0;\r\n    if (typeof options.autoplay === 'undefined') options.autoplay = false;\r\n\r\n    this._getDefaultProperties (options, DEFAULTS);\r\n\r\n    // get parent settings\r\n    AnimatableObject.call(this, scriptName, options);\r\n\r\n    // === public vars ===\r\n\r\n    this.moving = false;\r\n\r\n    // fill the views with a default value if no view was passed:\r\n    if (this.dirViews === null) this.dirViews = {down: this.views[0]};\r\n    if (this.talkViews === null) this.talkViews = {down: this.views[0]};\r\n\r\n    if (this.isPlayer === true && playerChar === '') {\r\n        playerChar = this.scriptName;\r\n        this.interactive = false;\r\n    }\r\n\r\n    // === internal vars ===\r\n    this._currentAction = null;     // used in movement\r\n    this._actionList = [];      // used in character control\r\n    this._movementVector = {};  // used in movement\r\n\r\n    game.addEventListener('update', this._onCycle.bind(this));\r\n\r\n    // add the character to the character list\r\n    characterList.push(this);\r\n    this.id = characterList.length - 1;\r\n    characterMap[scriptName] = this.id;\r\n\r\n    // add the resources of this element to the general game loadlist\r\n    // (so that we don't have to wait in the game for a character to load)\r\n    Loader.addToLoadQueue(this._resourceList);\r\n\r\n    console.log ('Character: created char ' + this.scriptName);\r\n    }\r\n\r\n    Character.prototype = Object.create(AnimatableObject.prototype);\r\n    Character.constructor = Character;\r\n\r\n    // === private vars ===\r\n\r\n    var characterList = [];\r\n    var characterMap = {};\r\n    var _options = {};\r\n    var playerChar = '';\r\n\r\n    // ==== static vars ====\r\n\r\n    //Character.player = null;\r\n\r\n    // ===== public functions ====\r\n\r\n    Character.prototype.say = function (text) {\r\n    game.pushAction (this, {action: 'say', text: text, blocking: true});\r\n    };\r\n\r\n    Character.prototype.walk = function (x, y, blocking, callback) {\r\n    game.pushAction (this, {action: 'move', goal: {x, y}, blocking: blocking, callback: callback});\r\n    //this._actionList.push({action: 'move', goal: {x, y}, blocking: blocking, callback: callback});\r\n    };\r\n\r\n    Character.prototype.setAsPlayer = function () {\r\n    playerChar = this.scriptName;\r\n    };\r\n\r\n    Character.prototype.changeRoom = function (roomName, x, y, dir, _noautochange) {\r\n    Room.get(this.roomName).removeElement(this);\r\n    this.previousRoom = this.roomName;\r\n    this.roomName = roomName;\r\n\r\n    // add the character to its room.\r\n    Room.get(this.roomName).addElement(this);\r\n\r\n    if (typeof x !== 'undefined') this.x = x;\r\n    if (typeof y !== 'undefined') this.y = y;\r\n    if (typeof y !== 'undefined') this.changeDir (dir);\r\n\r\n    if (playerChar === this.scriptName && _noautochange !== false) {\r\n        Room.load(roomName);\r\n    }\r\n    };\r\n\r\n    Character.prototype.changeDir = function (dirName) {\r\n    this.dir = dirName;\r\n    // change the current view to match the direction:\r\n    if (this.dirViews[dirName]) {\r\n        this.changeView(this.dirViews[dirName]);\r\n    }\r\n    };\r\n\r\n    Character.prototype.changeView = function (viewName) {\r\n    this.textures = this._viewTextures[viewName];\r\n    this.texture = this.textures[0];\r\n    };\r\n\r\n    // ==== internal functions ====\r\n\r\n    Character.prototype.runAction = function (action) {\r\n    // in case that we interrupted an action (when blocking: false), we reset the action flags:\r\n    this.moving = false;\r\n    //if (this._currentAction !== null) console.log ('Character: action interrupted: ' + this._currentAction.action);\r\n\r\n    this._currentAction = action;\r\n\r\n    if (this._currentAction.action === 'move') {\r\n        this._movementVector = this._calculateMovementVector(this._currentAction.goal);\r\n        this._updateDirection (this._movementVector);\r\n        this.play();\r\n        this.moving = true;\r\n    }\r\n\r\n    if (this._currentAction.action === 'say') {\r\n        this._textDisplayed = true;\r\n        this.speaking = true;\r\n\r\n        // create and position a new text element:\r\n        this._currentText = new renderer.Text(this._currentAction.text);\r\n        this._currentText.anchor.x = 0.5;\r\n        this._currentText.x = 0;\r\n        this._currentText.y = -this.height;\r\n        this._currentText.style.fill = this.speechStyle.color;\r\n        this.addChild (this._currentText);\r\n\r\n        console.log ('Text: --- ', this._currentText);\r\n\r\n        // set a game flag that says that there is currently an\r\n        // action running that blocks additions to action queues\r\n        game.currentState.blockingAction = true;\r\n\r\n        // provide a game-wide way to jump over the action:\r\n        game.currentState.passAction = this._stopTalking.bind(this);\r\n\r\n        // remove the text after a while\r\n        this._textTimeout = setTimeout(this._stopTalking.bind(this), 3000);     // TODO: calculate time.\r\n\r\n        // change the animation to the talking animation for the current direction (if available)\r\n        if (this.talkViews[this.dir]) {\r\n            console.log ('changing to talk view ' + this.dir);\r\n            this.changeView(this.talkViews[this.dir]);\r\n            this.play();\r\n        }\r\n    }\r\n\r\n    this.doStuff = true;\r\n    };\r\n\r\n    // the 'update' method of the character.\r\n    // method name 'update' is already taken, used for animation.\r\n    Character.prototype._onCycle = function (deltaT) {\r\n    if (this.doStuff === true) {\r\n\r\n        this.doStuff = false;\r\n\r\n        // get the next goal if don't have one or the action can be jumped over.\r\n        /*if ((this._currentAction === null || this._currentAction.blocking === false) && this._actionList.length > 0) {\r\n\r\n            this.runAction (this._actionList.shift());\r\n        }*/\r\n\r\n        // handle moving/walking stuff\r\n        if (this.moving === true) {\r\n            this.position.x += this._movementVector.x;\r\n            this.position.y += this._movementVector.y;\r\n            this.z = this.y + this.baseline;\r\n            game.currentState.zUpdated = true;\r\n            if (distance (this._currentAction.goal, this.position) < this.walkspeed) {\r\n                this.position.x = this._currentAction.goal.x;\r\n                this.position.y = this._currentAction.goal.y;\r\n\r\n                if (typeof this._currentAction.callback === 'function') {\r\n\r\n                    let listBuffer = this._actionList.slice(0);\r\n                    this._actionList = [];\r\n\r\n                    this._currentAction.callback();\r\n\r\n                    this._actionList = this._actionList.concat(listBuffer);\r\n\r\n                    // delete listBuffer;\r\n\r\n                    //console.log ('callback happened - new list: ', this._actionList);\r\n                }\r\n\r\n                this.moving = false;\r\n                this._currentAction = null;\r\n                this.gotoAndStop(0);\r\n            }\r\n            this.doStuff = true;\r\n        }\r\n        else if (this.speaking === true) {\r\n            if (this._textDisplayed === false) {\r\n\r\n                console.log ('Text finished.');\r\n\r\n                this.removeChild (this._currentText);\r\n                delete this._currentText;\r\n\r\n                this._currentAction = null;\r\n                this.speaking = false;\r\n                this.gotoAndStop(0);\r\n            }\r\n            this.doStuff = true;\r\n        }\r\n        // if none of the actions were called, we must be finished with the action cycle.\r\n        else {\r\n            game.nextAction();\r\n        }\r\n    }\r\n    };\r\n\r\n    Character.prototype._stopTalking = function () {\r\n    if (game.currentState.passAction === this._stopTalking)\r\n        game.currentState.passAction = null;\r\n    clearTimeout(this._textTimeout);\r\n    this._textDisplayed = false;\r\n    };\r\n\r\n    Character.prototype._updateDirection = function (mV) {\r\n    var xD = 1;\r\n    var yD = 1;\r\n    if (mV.x < 0) xD = -1;\r\n    if (mV.y < 0) yD = -1;\r\n    if (abs(mV.x) > abs(mV.y)) {\r\n        if (xD === 1) this.changeDir ('right');\r\n        else this.changeDir ('left');\r\n    }\r\n    else {\r\n        if (yD === 1) this.changeDir ('down');\r\n        else this.changeDir ('up');\r\n    }\r\n    };\r\n\r\n    Character.prototype._calculateMovementVector = function (point) {\r\n    var d = distance(point, this.position);\r\n    var v = {};\r\n    var dY = point.y - this.position.y;\r\n    var dX = point.x - this.position.x;\r\n\r\n    if (d >= 1) {\r\n        var aX = dX/d;\r\n        var aY = dY/d;\r\n        v = { x: this.walkspeed * aX, y: this.walkspeed * aY};\r\n    }\r\n    else {\r\n        v = {x: dX, y: dY};\r\n    }\r\n    return v;\r\n    };\r\n\r\n    Character.prototype._attachLoadedTexture = function () {\r\n    // make sure all the texture attaching gets done correctly\r\n    AnimatableObject.prototype._attachLoadedTexture.call(this);\r\n\r\n    // setting the anchor automatically. TODO: Should be configurable.\r\n    //this.anchor.x = 0.5;\r\n    //this.anchor.y = 1;\r\n    };\r\n\r\n    Character.prototype._handleFrameChange = function () {\r\n\r\n    // skip the first frame of the walking view cycles:\r\n    if (this.moving && this.currentFrame === 0) {\r\n        //console.log ('skipping one frame.');\r\n        // move a frame ahead\r\n        this._currentTime = 1;\r\n        this._texture = this._textures[this.currentFrame];\r\n    }\r\n    };\r\n\r\n    Character.prototype._getSaveData = function () {\r\n\r\n    // save all the default values from the inherited class\r\n    var saveData = AnimatableObject.prototype._getSaveData.call(this);\r\n\r\n    // save all the properties that can be set in the defaults\r\n    for (var property in DEFAULTS) {\r\n    \tif (this.hasOwnProperty(property)) {\r\n    \t\tsaveData[property] = this[property];\r\n    \t}\r\n    }\r\n\r\n    // get the other values\r\n    var i = saveValues.length;\r\n    while (i--) {\r\n    \tsaveData[saveValues[i]] = this[saveValues[i]];\r\n    }\r\n\r\n    return saveData;\r\n    };\r\n\r\n    // === public static functions ===\r\n\r\n    Character.get = function (characterName) {\r\n    if (typeof characterMap[characterName] === 'undefined') {\r\n    \tconsole.error (\"Kein Charakter mit dem Namen \" + characterName + \" vorhanden.\");\r\n    }\r\n    var charId = characterMap[characterName];\r\n\r\n    return characterList[charId];\r\n    };\r\n\r\n    Character.getPlayer = function () {\r\n    return Character.get(playerChar);\r\n    };\r\n    Character.setPlayer = function (scriptName) {\r\n    Character.getPlayer().interactive = true;\r\n    playerChar = scriptName;\r\n    Character.getPlayer().interactive = false;\r\n    };\r\n\r\n    // === private static functions ===\r\n\r\n    // called when a place in a room was clicked where there is no object\r\n    var handleRoomClick = function (clickPlace, event) {\r\n    if (playerChar !== '') {\r\n        var p = Character.getPlayer();\r\n\r\n        // user-editable click event hook\r\n        if (!game.currentState.blockingAction) {\r\n            p.walk(clickPlace.x, clickPlace.y, false);\r\n        }\r\n        else if (typeof game.currentState.passAction === 'function') {\r\n            console.log ('Character - Room Click: aborted current action.');\r\n            game.currentState.passAction();\r\n        }\r\n        else {\r\n            console.log ('Character - Room Click: Click ignored.');\r\n        }\r\n    }\r\n    else console.error('No player character defined.');\r\n    };\r\n\r\n    // ==== used utility functions ====\r\n\r\n    // get the distance between two points\r\n    function distance( point1, point2 )\r\n    {\r\n    var xs = 0;\r\n    var ys = 0;\r\n\r\n    xs = point2.x - point1.x;\r\n    xs = xs * xs;\r\n\r\n    ys = point2.y - point1.y;\r\n    ys = ys * ys;\r\n\r\n    return Math.sqrt( xs + ys );\r\n    }\r\n    // absolute value\r\n    function abs( number ) {\r\n    if (number < 0) number *= -1;\r\n    return number;\r\n    }\r\n\r\n    // === game preparation function ===\r\n\r\n    // load everything from the configuration and wire the properties into real files.\r\n    function createCharacters () {\r\n\r\n    // get the data to build the characters from.\r\n    var characterConfig = game.gameData.character;\r\n\r\n    if (typeof characterConfig === 'undefined') {\r\n        console.error ('Character: Keine Charaktere eingestellt. Mindestens ein Character wäre super.');\r\n        return;\r\n    }\r\n\r\n    // split the options from the rest of the settings object:\r\n    _options = characterConfig.options;\r\n    delete characterConfig.options;\r\n\r\n    // rework the defaults based on the character options.\r\n    // TODO!\r\n    //DEFAULTS = options.defaults.\r\n\r\n    // make characters from the rest of the array:\r\n    for (var charName in characterConfig) {\r\n        new Character (charName, characterConfig[charName]);\r\n    }\r\n\r\n    console.log ('Characters: All characters created: ', characterList);\r\n    console.log ('-----');\r\n    };\r\n\r\n    // called after all the textures for the characters are loaded.\r\n    function positionCharacters () {\r\n    var i = characterList.length;\r\n    while (i--) {\r\n        // attach the textures that have been loaded.\r\n        characterList[i]._attachLoadedTexture();\r\n\r\n        // add the character to its room.\r\n        Room.get(characterList[i].roomName).addElement(characterList[i]);\r\n    }\r\n    }\r\n\r\n    // saving the characters:\r\n    game.addEventListener ('beforeSave', function () {\r\n\r\n    var saveChars = {};\r\n\r\n    saveChars.settings = {\r\n    \tplayerChar: playerChar,\r\n    };\r\n\r\n    // loop through all the characters and save each one.\r\n    var i = characterList.length;\r\n    while (i--) {\r\n    \tconsole.log ('saving char ' + characterList[i].scriptName);\r\n    \tsaveChars[characterList[i].scriptName] = characterList[i]._getSaveData();\r\n    }\r\n\r\n    game._saveData.character = saveChars;\r\n    });\r\n\r\n    // process a load event\r\n    game.addEventListener ('onSavegameLoad', function () {\r\n\r\n    // get the data to build the characters from.\r\n    var characterConfig = game._saveData.character;\r\n\r\n    // split the options from the rest of the settings object:\r\n    _options = characterConfig.settings;\r\n    delete characterConfig.settings;\r\n\r\n    playerChar = _options.playerChar;\r\n\r\n    // loop through all the rooms in the save:\r\n    for (var charName in characterConfig) {\r\n    \tvar r = Character.get(charName);\r\n\r\n    \t// change all the properties of the current rooms to the saved props.\r\n    \tfor (var variable in characterConfig[charName]) {\r\n            // room changing:\r\n            if (variable === 'roomName') {\r\n                r.changeRoom(characterConfig[charName][variable]);\r\n            }\r\n            else {\r\n                r[variable] = characterConfig[charName][variable];\r\n            }\r\n    \t}\r\n    }\r\n\r\n    console.log ('CHARACTER: Load -> all character properties loaded.');\r\n    });\r\n\r\n    game.addEventListener ('afterSavegameLoad', function () {\r\n    var player = Character.getPlayer();\r\n    // change the room if the player character is not in its room anymore\r\n    if (Room.getCurrent() !== player.roomName) {\r\n        player.changeRoom(player.roomName);\r\n    }\r\n    });\r\n\r\n    // add listeners to events:\r\n    game.addEventListener('prepare', createCharacters);\r\n    game.addEventListener('game_loaded', positionCharacters);\r\n\r\n    game.addEventListener('room_click', handleRoomClick);\r\n\r\nexport default Character;\r\n","// Extend the room to support the addition of objects.\r\n\r\nimport Room from './Room.js';\r\nimport AnimatableObject from './AnimatableObject.js';\r\nimport InteractiveObject from './InteractiveObject.js';\r\n\r\n//Game.addComponent ('room_object', ['room', 'interactive_object', 'animatable_object'], function (game, Room, InteractiveObject, AnimatableObject) {\r\nfunction addRoomObjectComponent (game) {\r\n\r\n    // extend Room prototype to add object support:\r\n    Room.prototype.objectList = [];\r\n    Room.prototype.objectMap = {};\r\n\r\n    Room.prototype.addObject = function (scriptName, options) {\r\n\r\n        var newObject = null;\r\n\r\n        // create an animatable object or a standard object\r\n        let animatable = options.animatable;\r\n        delete options.animatable;\r\n        if (animatable === true) {\r\n            newObject = new AnimatableObject(scriptName, options);\r\n        }\r\n        else {\r\n            newObject = new InteractiveObject(scriptName, options);\r\n        }\r\n\r\n        // add the object to the room object list\r\n        this.objectList.push (newObject);\r\n\r\n        // set the object id\r\n        newObject.id = this.objectList.length - 1;\r\n        this.objectMap[scriptName] = newObject.id;\r\n\r\n        // add the image to the list of resources to load when entering the room:\r\n        var oRes = newObject._resourceList.length;\r\n        while (oRes--) {\r\n            this._resourceList.push(newObject._resourceList[oRes]);\r\n        }\r\n\r\n        // set the name of the objects room\r\n        newObject.roomName = this.scriptName;\r\n\r\n        // when the object's room loads, load the object.\r\n        game.addEventListener('room_loaded', onLoadRoom.bind(null, newObject));\r\n\r\n        console.log ('RoomObjects: created object ' + newObject.scriptName);\r\n    };\r\n\r\n    Room.prototype.deleteObject = function (objectName) {\r\n        var id = this.objectMap[objectName];\r\n\r\n        // remove the object from the scene\r\n        this.removeElement (this.objectList[id]);\r\n\r\n        // remove the objects texture from the resource list\r\n        this._resourceList.splice(this._resourceList.indexOf(this.objectList[id].image), 1);\r\n\r\n        // remove the object from the object name map\r\n        delete this.objectMap[objectName];\r\n\r\n        // replace the object with null.\r\n        // todo: reorder the whole object list... or not?\r\n        this.objectList[id] = null;\r\n    };\r\n\r\n    // load event - called when all the resources in the room are loaded.\r\n    function onLoadRoom (object, roomName) {\r\n        // only load it if the loaded room is the room the object is in.\r\n        if (roomName !== object.roomName) return;\r\n\r\n        // create the image element of the object\r\n        if (!object._loaded) object._attachLoadedTexture ();\r\n\r\n        // add the element to the room layer\r\n        var room = Room.get(roomName);\r\n        room.addElement(object);\r\n\r\n        console.log ('RoomObject: loaded object ' + object.name, object);\r\n        //console.log ('Object is interactive: ', object.interactive);\r\n    }\r\n\r\n\r\n    // ********** EVENT HOOKS *****************\r\n\r\n    // on game load:\r\n    game.addEventListener ('prepare', function () {\r\n        var config = game.gameData.room_object;\r\n\r\n\t\t// split the options from the rest of the settings object:\r\n\t\tvar options = config.options;\r\n\t\tdelete config.options;\r\n\r\n        // go through all the listed rooms\r\n        for (var roomName in config) {\r\n            if (config.hasOwnProperty(roomName)) {\r\n                var roomObjects = config[roomName];\r\n\r\n                var currentRoom = Room.get(roomName);\r\n\r\n                // ...and create all the objects listed there.\r\n                for (var objectName in roomObjects) {\r\n                    if (roomObjects.hasOwnProperty(objectName)) {\r\n                        currentRoom.addObject(objectName, roomObjects[objectName]);\r\n                        //new RoomObject (currentRoom, objectName, roomObjects[objectName]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    game.addEventListener ('beforeSave', function () {\r\n\r\n        // loop through all the rooms:\r\n        //for (var roomId in Room.roomList) {\r\n        //\r\n        //}\r\n    });\r\n\r\n}\r\n\r\nexport default addRoomObjectComponent;\r\n","import Game from './Base_Game.js';\r\n\r\nimport Renderer         from './components/Renderer.js';\r\nimport Loader           from './components/Loader.js';\r\n\r\nimport GameObject           from './components/GameObject.js';\r\nimport SaveableObject       from './components/SaveableObject.js';\r\nimport Room                 from './components/Room.js';\r\nimport InteractiveObject    from './components/InteractiveObject.js';\r\nimport AnimatableObject     from './components/AnimatableObject.js';\r\nimport Gui                  from './components/Gui.js';\r\nimport Character            from './components/Character.js';\r\nimport RoomObject           from './components/RoomObject.js';\r\n\r\nimport gamedata             from './gamedata.js';\r\n\r\n\r\n\r\nvar roomName = \"index\";\r\nvar boxwidth = document.getElementById (\"game_container\").offsetWidth;\r\nif (boxwidth < 1000) boxwidth = 1000;\r\n//else if (boxwidth > 1920) boxwidth = 1920;\r\n\r\nvar options = {\r\n    gameContainer: 'gamebox',\r\n    width: boxwidth,\r\n    height: 480\r\n};\r\n\r\n// the game is created with the options.\r\nvar game = new Game(options, gameData);\r\n\r\nconsole.log (game);\r\n\r\ngame.init ();\r\n\r\n//Game.addComponent ('renderer', [], new Renderer() );\r\n"],"names":["PIXI","renderer","saveValues","DEFAULTS","_options","AnimatableObject","game"],"mappings":"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"}